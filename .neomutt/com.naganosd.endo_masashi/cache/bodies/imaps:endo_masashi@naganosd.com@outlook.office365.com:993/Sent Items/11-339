Received: from Kx250 (125.30.78.83) by TYAPR04CA0001.apcprd04.prod.outlook.com
 (2603:1096:404:15::13) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2921.25 via Frontend
 Transport; Mon, 20 Apr 2020 23:58:41 +0000
Date: Tue, 21 Apr 2020 08:58:39 +0900
From: masashiendou <endo_masashi@naganosd.com>
To: NSD Mizuki Tonouchi <tonouchi_mizuki@naganosd.com>
Cc: tanahashi_katsuhiro@naganosd.com
Subject: =?utf-8?B?MjAyMDA0MjDml6XloLEgKOmBoOiXpCk=?=
Message-ID: <20200420235839.73veswarc3b7ciqg@Kx250>
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:68.0) Gecko/20100101
 Thunderbird/68.7.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Language: en-US
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
X-MS-Exchange-Organization-ExpirationStartTime: 20 Apr 2020 23:58:42.0796
 (UTC)
X-MS-Exchange-Organization-ExpirationStartTimeReason: OriginalSubmit
X-MS-Exchange-Organization-ExpirationInterval: 1:00:00:00.0000000
X-MS-Exchange-Organization-ExpirationIntervalReason: OriginalSubmit
X-MS-Exchange-Organization-Network-Message-Id:
 d0b01f8e-b123-418d-8d70-08d7e586c0e4
X-MS-Exchange-Organization-AuthSource: HK0PR06MB2739.apcprd06.prod.outlook.com
X-MS-Exchange-Organization-AuthAs: Internal
X-MS-Exchange-Organization-AuthMechanism: 06
X-Originating-IP: [125.30.78.83]
X-ClientProxiedBy: TYAPR04CA0001.apcprd04.prod.outlook.com
 (2603:1096:404:15::13) To HK0PR06MB2739.apcprd06.prod.outlook.com
 (2603:1096:203:55::19)
X-MS-Exchange-Organization-MessageDirectionality: Originating
Return-Path: endo_masashi@naganosd.com
MIME-Version: 1.0

登内様

遠藤です

昨日(4/20)の日報を送ります。

●あいまい仕様 / 仕様書と客先提供DBの不一致対応
　◆MINO様とのメールのやり取り
　 ▼三宅様
　　　- 仕様書と客先提供DBの不一致対応
　　　　 MINO-48 ラベル・送り状発行の仕様書 / DB不一致の改善
　　　　　-> 4/17 日・祝日の表示
　　　　　　　　　DBの提供が無さそうなのでこちらでテーブル含めて用意する必要するかどうかを決める
　　　　　-> 4/20 三宅様からは祝日テーブル+関数で対応依頼、北澤様からはphpコードで外部サイト連携させて対応依頼が、それぞれあった
　　　　 MINO-49 製作出荷詳細情報の仕様書 / DB不一致の改善
　　　　　-> 4/17 出荷サイン
　　　　　　　　　MINO様側にて仕様書修正とDBの作成待ち
　　　　　-> 4/20 三宅様よりDB変更のためのSQLを提供いただいた
　　　- あいまいな仕様の要件確認
　　　　 MINO-52 ラベル・送り状発行の仕様確認 ( 担当者仕訳/発行ボタン/ミニ )
　　　　　-> 4/17 "M_AI_TANTOUSYA_IRO_KBN（新規）の担当者"について
　　　　　　　　　"ミニ"チェックボックスについて
　　　　　　　　　　-> MINO様側にて仕様書修正とDBの作成待ち
　　　　　-> 本日(4/21)実装時の選択方法、必須かどうか、主キーの問題について質問済み

　◆DB変更に対してのcakephpのmigration対応
　　"あいまい仕様 / 仕様書と客先提供DBの不一致対応"の作業により、DBの更新が頻発しているためデグレードの可能性が高い
　　このため、cakephpのmigration機能により、DB変更作業をコード化してgithubで履歴管理する
　　取り急ぎ、手動でDB更新が必要なので以下課題で管理する
　　　MINO-58 cakephpのmigrationでDB変更をコード化する

　◆リリースノートへの落とし込み
　　"あいまい仕様 / 仕様書と客先提供DBの不一致対応"の作業により、案件当初の仕様書およびMINO様提供のDBから、ズレが生じている
　　このためズレの解消作業による作業遅延が発生して、それに伴い各マイルストーンのリリースに含めることが出来る画面/機能、出来ない画面/機能
　　が出てくるので、以下Backlogのwikiを随時更新して、MINO様との認識合わせを進める
　　　https://naganosd.backlog.com/alias/wiki/350443


●既存コードのバグに起因する対応
　◆不備部分の調査
　　->4/14 新規登録
　　　　　　MINO-45 Ajaxのnullのハンドリング処理を修正する
　　　　　  MINO-46 ajax controllerの日付フォーマット処理の修正
　　　　　  MINO-47 テーブルカラムの値をキーに他テーブルカラムの値を取得するロジックの修正


●製作出荷詳細の進捗状況
　◆作業済み
　◆作業中
　　- 出荷サイン
　　- 製造可能サイン
　　- オーダー番号
　　- ロケーション
　　- 希望出荷日
　　- 着日指定
　　- 配達時間
　　- 送り先区分
　　- 運送会社
　　- 営業所
　　- 送り先
　　- 住所1
　　- 住所2
　　- 送り先名
　　- 備考
　　- 送り先記入欄
　　- 費用
　　- ミニ
　　- 地図
　◆仕様確認が必要
　　- 送り先クリアボタン(Ajaxで表示のクリア)
　　- 送り先担当
　　- 手配担当
　　- 製作場所
　　- 製品タイプ
　◆未着手
　　- 登録ボタン(DB更新処理)


●ラベル・送り状発行の進捗状況
　◆残作業
　　▼棚橋様に確認いただき以下のバグが見つかったため修正中
　　  - MINO-55 ラベル・送り状発行：指示ラベルをクリックすると、アクションが発生する
　　　　-> 未着手
　　  - MINO-56 ラベル・送り状発行：数値入力のテンキーが＋、－の電卓になっている
　　　　-> 4/20 修正中
　　  - MINO-57 ラベル・送り状発行：入力枚数が保持される
　　　　-> "MINO-5 製作出荷詳細(画面)"でDB更新を実装する前に、MINO-57の対処をする
　　▼仕様の確認中
　 　　- 物件名ラベル発行
　　▼仕様の確認が必要
　 　　- 日・祝の表示
　　　　->4/16 土曜の扱いも含める
　 　　- 送り状まとめ発行
　　▼仕様の問題で現状実装不可
　　　 - ミニ


●棚橋様による作業支援
　◆あやふやな仕様の取り扱い
　　-> 4/8 動作が明確でない仕様を棚橋様からご指摘頂いた
　　　　　 MINO様へのリリースメールにて、認識を合わせる予定
　◆画面の評価に必要なDBカラムを変更するクエリの作成
　　 - MINO-23(ラベル・送り状発行)
　　　　->4/9 動作確認用のDB更新クエリを作成頂いた
　　 - MINO-24(臨時出荷登録)
　　　　->4/10 動作確認用のDB更新クエリを作成頂いた
　　 - MINO-16(製作出荷情報)


作業予定
-------------------------------------------------------
# MINO #
●AjaxControllerのクラス名の修正
　Ajax処理の発火の条件指定となっているクラス名が判別しづらいため、マイルストーンVer_1.0の期間中に修正予定

●大文字のTable名の問題
　　-> 3/31 
客先提供のDBで、Table名が大文字でありcakephpの規約に則していない、これによりcakephpの長所であるbakeコマンドが使用できず開発効率が落ちている
　　　　　　MVCのアンチパターンを踏んでしまっているので、システムの改修に弱い設計
　　　　　　このため、Ver_1.0リリースのマイルストーン内で当該作業の実施を推奨
　　-> 4/1  MINO 北澤様宛に以下のとおりメール
　　　　　　　ご提供いただいているDBのテーブル名が大文字であるため、cakephpの規約に則していない状態
　　　　　　　実装自体は出来るものの、bakeコマンドが使用できないのでcakephpのメリットが
　　　　　　　活かせていない
　　　　　　　今後、仮に軽微な改修が発生した場合、必要以上の工数となってしまう可能性が高い
　　　　　　　　1. 当DBのテーブル名は、他のシステムとの兼ね合いもあって、テーブル名が大文字なのか？
　　　　　　　　2. 他システムへの影響がなければ、大文字から小文字への変更は可能か?
　　　　　　以下のとおり返信をいただいた
　　　　　　　テーブルを小文字に変更することは難しいが、風車(ふうしゃ)というcakephp3を使用して作成したシステムで、
　　　　　　　小文字のテーブル作って、表テーブルにして使用している
　　　　　　　新しくshippingというデータベースを作って、表テーブルを作成することも可能
　　　　　　　開発効率が著しく落ちるということであれば、可能
　　-> 
4/3にマイルストーンVer1.0のスケジュール内でMINO北沢様に新しくshippingというデータベースを作って、表テーブルを作成頂くよう依頼する予定
　　-> 4/3 MINO 北澤様と協議の結果、マスターTableからViewTableを作成して小文字対応して頂くこととなった
　　　　　 既存Tableとの変更点は別途指定頂く予定
　　-> 4/7 MINO 北澤様より、shipmentDBとビューテーブルの作成手順をお教えいただいた
　　　　　 Ver_1.0リリースの作業期間にて、*.sqlの形式で一括変換のクエリを作成、MINO様と共有する予定

●Github連携
　Backlog上でGithubを使おうとすると、Backlogドメインのレポジトリ作成になるため、当該機能は使用しない
　代わりにWebhook機能を使用し、Githubコミット時にプッシュ通知する設定を行う
●ログイン画面/機能(MINO-14/22)
　◆MINO-14
　　3/23 遠藤追記
　　パスワード表示/非表示ボタンがあるが、仕様には未記載のため取り除く
　　Viewで取り扱う画面表示についてのメモは、当該課題に追記していく
　◆MINO-22
　　3/23 遠藤追記
　　　cakephpのvalidationが未実装
　　　beforefilterで、ユーザと管理者の区別はついている模様
　　　仕様に従い、以下を実装する
　　　仕様書: https://naganosd.backlog.com/file/MINO/AI%E5%87%BA%E8%8D%B7%E4%BB%95%E6%A7%98_20200203.xls
　　　
　　   社員番号を入力すると、名前を表示
　　    　※M_USER USER_CD に一致した USER_NM1 と USER_NM2 検索し表示する
　　　    　　-> 未実装
　　   社員番号が見つからない場合は、エラーメッセージを出す
　　  　　 -> 未実装、現状未入力画面に戻るのみ
　　   M_USER USER_CD と USER_PWD が一致しない場合、エラーメッセージを出す
　　   　　-> 未実装、現状未入力画面に戻るのみ
　　   　　　 一致する場合、ログインおよび右上に名前が表示される状態
　　　 社員番号を保存する レ点が付いている場合、ログインが出来た時、社員番号を保存する
　　　   　-> 未実装
　　　   次回ログイン時に、社員番号と名前を表示する
　　　   　-> 未実装
　　　   M_USER_SYOZOKU の LOCATION_CD を覚えておく
　　　   　-> 未実装
　　　
　　　当該機能に関係するファイル一式
　　　  www/src/Controller/AppController.php
　　　  www/src/Model/Table/MUserTable.php
　　　  www/src/Template/Users/login.ctp
　　　  www/src/Controller/UsersController.php


作業済み
-------------------------------------------------------
# MINO #
●MINO-23 ラベル・送り状発行 ( 画面 )
　◆Controllerの作成
　　-> 4/1 ヘッダーに既にあるリンクを、新規のパスに指定する
　　-> 4/2 "LabelsIssuanceController"を作成した
　◆Routingの設定
　　-> 4/1 新規パスを用意して、ルーティングする
　　-> 4/2 新規のパス"src/Template/LabelsIssuance"に指定した
　◆src/Template/以下にフォルダとindex.ctpを作成
　　-> 4/1 新規パスの名前でフォルダを作成して、以下の仕様通り画面のコーディングを進めている
　　　　　　https://naganosd.backlog.com/alias/file/6871118
　　-> 4/3 cssのgrid layoutで画面をコーディング中
　　-> 4/4 画面のレイアウトは、ほぼ実装済み
　　　　　 DBを参照して表示を変更する部分を実装すれば、作業終了
　　-> 4/5 DB周りの作業は、日報の最上部で別途管理するため作業済みに移動


保留(MINO案件以外)
-------------------------------------------------------
# RCS #
●検証環境の差分の把握(Backlogに課題を登録済み(HAMA-153))
　-> 3/17 Dropbox上の手順とRedmine上の手順の2つがあるため、差分を把握する必要がある
　　　　　下村様に、Vagrant環境の設定ファイル一式を共有するよう依頼した
　　　　　取り急ぎ、Dropbox版検証環境にてHAMA-77で実施している差し替え反映の手順を確認中
　-> 3/17 遠藤検証環境(https://localhost:8080/auth?fgCd=1jj2NSakr8FEfzhY)にて、商品登録を試みたが反映されない
　　　　　ログを確認しようとしたが、RCSのログ出力先が分からなかったため、明日(3/18)下村様に質問予定
　　　　　※HAMA-132にてログ取得を実装するとの記載があるが、HAMA-138を見る限り未実装のようにも見える
　-> 3/18 
朝ミーティングで、過去にWindows環境で当該検証構築手順で正常動作したとのことであったが、遠藤手持ちのLinux環境Windows環境共に正常動作しなかった
　　　　　このため、下村様PCのvagrant環境をpackage.boxとして共有、合わせてVagrantfileを共有頂くよう依頼した
　-> 3/19 朝ミーティングで、下村様PCのVagrant環境を情報共有頂くよう再度依頼した
　-> 3/19 armeria-chefのファイル一式をDropboxに保存していただいた
　　　　　"https://www.dropbox.com/home/700_%E6%8A%80%E8%A1%93%E9%96%8B%E7%99%BA%E9%83%A8/720_RCS%E3%83%BBRSS/RCS%E3%82%B5%E3%83%BC%E3%83%90%E6%A7%8B%E7%AF%89/%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83/armeria-chef"

●Backlog課題の整理
　◆新規課題を遠藤に割当
　　RSS-10 「サンマルタン」admin画面で客室の重複がある
　　HAMA-158 商品登録時に設定により表示崩れが発生する

　◆引継ぎ用課題の作成
　　-> 3/16 親課題として、HAMA-149(業務引継(下村さん->遠藤))を登録
　　　 "https://naganosd.backlog.com/view/HAMA-149"
　　　 当課題に子課題を3つ登録(HAMA-150, 151, 152)
　　　▼処理済み(HAMA-150(担当:遠藤))
　　　　　-> 3/16 下村様がアップロードおよび添付した資料を元に、検証環境で更新・削除の流れを確認
　　　　　　 　　 本番環境で、実際には作業はしないが、手順の流れに不備がないか確認
　　　　　　　　　本番環境へのデプロイ手順で、EC2インスタンス名が古く、現在のAWS構成と食い違っているので、同手順について下村様に修正を依頼済み
　　　　　-> 3/17 朝ミーティングで手順書の更新を下村様に依頼した
　　　▼未対応(HAMA-151(担当:下村様))
　　　　　-> 3/16 HAMA-141, HAMA-142, HAMA-143, HAMA-145, HAMA-147
　　　　　　 　　 について、状態が"未対応"
　　　　　　 　　 
このため、下村様には各課題について、手順があるならファイル添付またはWikiリンク記載、無いなら内容もしくは確認すべき対象を遠藤に伝えて、各課題を"処理中"とする対応を依頼済み
　　　　　-> 3/16 当該子課題に対応する下村様担当の課題について記入いただき、状態を全て「処理済み」に変更
　　　　　　　　　外部リンクが複数有るが、概ね理解できる範囲内
　　　　　　　　　登内様にご確認いただき問題なければ、当該子課題を完了とする
　　　　　-> 3/17 朝ミーティングで登内様に確認を依頼した
　　　▼未対応・処理中(HAMA-152(担当:下村様))
　　　　　-> 3/16 HAMA-77, HAMA-114, HAMA-115, HAMA-126, HAMA-134, HAMA-135
　　　　　　 　　 について、状態が"未対応または処理中"
　　　　　　 　　 このため、下村様が現時点で把握している内容を、各課題に記載を依頼
　　　　　　 　　 未着手であれば、未着手であることを記載を依頼
　　　　　-> 3/16 当該子課題に対応する下村様担当の課題について以下のとおり確認、記入いただいた
　　　　　　　　　　HAMA-77 -> 現状の対応状況を記入、担当者を遠藤に変更
　　　　　　　　　　HAMA-114 -> 連携のスケジュールということで、状態を完了に変更
　　　　　　　　　　HAMA-115 -> 現状の対応状況を記入、担当者を遠藤に変更
　　　　　　　　　　HAMA-126 -> 客先より連絡が無いため、一旦状態を完了に変更
　　　　　　　　　　HAMA-134 -> 
従来のプリンタについて不具合は対応済み、ここ数ヶ月の不具合について追記、状態を完了に変更
　　　　　　　　　　HAMA-135 -> 未対応・未調査、担当者を遠藤に変更
　　　　　　　　　下村様にて、HAMA-152の状態を"完了"に設定いただいた


●RSS(RCSの旧システム)の引継
　◆検証環境の確認
　　-> 3/16 DropboxとRedmineの資料を確認中
　◆本番環境の確認
　　-> 3/16 DropboxとRedmineの資料を確認中
　◆下村様作業
　　-> 3/16 バックアップの取得と共有を登内様から下村様に依頼済み
　
●仕様確認
　◆"業務覚書.txt"に記載の"implement.pptx"を読み込み、RCSの仕様を確認中
　◆構築した検証環境で、RCSの動作を確認中
　フォルダ:
　　/Dropbox(長野システム開発株式会社)/700_技術開発部/720_RCS・RSS/RCSサーバ構築/RCS開発環境構築
　ファイル:
　　業務覚書.txt
　Github:
　　/NaganoSystemDevelopment/armeria/documents/implement.pptx
　　-> 3/13 引き続き確認中


●xcodeのビルド環境(ios)構築手順の引き継ぎ
　　-> 3/17 当作業についての課題をBacklogに作成した(HAMA-154)
　　　　　　長野システム株式会社側のMacと遠藤PC間をTeamViewerで接続して、当該環境を整える
　　　　　　　- TeamViewerのアカウント情報の連絡待ち
　　　　　　登内様より、下村様から遠藤に、通知アプリとRSSプロファイル更新についてレクチャーをするよう依頼があった(キタハラ様、ミヤザワ様と連携とのこと)
　　　　　　　- 下村様からの連絡待ち
　　-> 3/18 
長野システム株式会社にあるMacは下村様使用中のものが、性能的にビルド環境に最も適していて、かつ既に環境構築済みとのこと
　　　　　　このため、当該Macと遠藤PC間をTeamViewerで接続して運用する方向で進める

●バリデーションエラーについて
　-> 3/12 下村様からヒアリング
　-> 3/16 BacklogまたはTeamsのWikiに、現状判明している内容を登録する
　◆管理者が商品を削除したときに、ユーザ側でカートに商品を追加していると(チェックアウトしていない状態のとき)不具合が発生する
　　・原因として、当該処理中に中間テーブル上レコードの論理削除が行われるが、
　　　カテゴリに関連づいているテーブルのレコードは完全に削除されて、
　　　Ajaxの処理が間に合わないときに、当該エラーが発生すると思われるとのこと


●レガシー環境から新しい環境への移行検討
　-> 3/12 下村様からヒアリング
　-> 3/16 BacklogまたはTeamsのWikiに、現状判明している内容を登録する
　◆PHPを最新版7.x.xに出来ない
　　・Zendが7.x.xのPHPに未対応のため
　　・WEBサーバ(Nginx)は可能


# AWS #
●旧バグ/Wiki管理(Redmine)システムについて
　-> 3/12 Redmineの遠藤用のアカウントを下村様に作成いただいた
　-> 3/13 バックログに当作業の課題を登録した
　　 インスタンスタイプの変更は着手できなかったため、3/16以降で調整する
　　　　　当作業により変動する費用の概算を課題に記載した
　　　　　　※補足：停止しているインスタンスに関するEBSについては、何かしかのバックアップをしておく予定
　　　　　　　　　　取得したバックアップはDropboxに保管予定
　　　　　　　　　　EBS全体の容量は1TB、しかし実用量は100GB未満と思われる
　　　　　　　　　　当作業は、課題を概要にまとめて実作業は来週以降の予定
　　◆Vagrantの検証環境の作成は、当該Wikiを参照して下村様は作成
　　　このため、Dropbox上の手順と食い違いがある　
　　◆Redmineに使用しているEC2は社外公開しておらず、パフォーマンスは特別必要ないので、インスタンスタイプは小さくすることが可能
　　　※t1.micro -> nano とする予定
　　　※下村様に確認済み

●プラン見直し
　◆停止しているインスタンスのほぼ全てに、EBSが関連付けられている
　　このため、不要な費用が発生している
　　Redmineが動作しているインスタンスが2つあり、セキュリティグループはWalts
　　RCSと関係ないインスタンスであれば、タグ付をして、RCSの費用計算外としたい
　　RCSと関係あるインスタンスであれば、T1.micro -> T2.nanoにインスタンスタイプを変更して、費用を削減したい
　　-> 3/12 下村様よりRedmineについては、社外公開用などではないとのこと
　　-> ただし、2つの内1つ(ip: 54.178.113.120)は今までのRCSで使用してきたインスタンスだが、もう一つ(ip: 
54.238.51.139)は用途不明とのこと

　◆RI(リザーブドインスタンス)
　　途中でインスタンスタイプを変更すると、割引適用外となってしまうので、過去にBacklogのHAMA-42で議論された、CPU負荷の問題点を明らかにしてから、検討したほうが良いと推察される
　　-> 3/12 CPU高負荷の原因はバックアップによるもので、利用者のアクセスは無関係
　　-> インスタンスタイプをc3.largeから安価なタイプに変更しても、RCSのサービス自体に影響はないと思われる
　　-> 
しかし、c3.largeは古いインスタンスタイプのため、新しいインスタンスタイプに移行するにはAMIが未対応とのこと(下村様に確認済み)
　　-> 3/16 以降、移行手順、およびどのインスタンスタイプへの移行が適切なのか調査を進める

●AWS利用状況の確認
　◆お教えいただいたアカウントにて、現状の構成の確認
　　取り急ぎ、RDSへの移行状況について下村様に質問をして、回答待ち
　　-> 3/12 下村様より以下のとおり回答いただいた
　　　▼EC2上のDB → RDS
　　　　・RDSに移行したほうが料金が高くなるので、現状はEC2のままの方が良い
　　-> 3/16以降 BacklogまたはTeamsのWikiに、現状判明している内容を登録する


よろしくお願いします。

以上
-- 
長野システム開発株式会社
遠藤 將司 ( Masashi Endo )
e-Mail <endo_masashi@naganosd.com>
〒399-4301 長野県上伊那郡宮田村5672-2
URL: http://www.naganosd.com/
